importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-sw.js");workbox.setConfig({debug:!1});workbox.precaching.precacheAndRoute([{"revision":"d5012c04f1b3cd46fb08203b3a844b73","url":"404.html"},{"revision":null,"url":"assets/index-5MLta6ni.css"},{"revision":null,"url":"assets/index-BELWJF0m.js"},{"revision":null,"url":"assets/index-ywwUAhIw.js"},{"revision":null,"url":"assets/workbox-window.prod.es5-B9K5rw8f.js"},{"revision":"7f04e301d6d866a87f62525ad74ebe06","url":"index.html"},{"revision":"c29cc7cc112f8bcdd32fd0b00b935985","url":"workbox-5ffe50d4.js"},{"revision":"ac73f380ba0147f4fa5951dfaba2a665","url":"images/logo.png"},{"revision":"a21d828dd87fdb1bf7ebbb3707e5cc2a","url":"manifest.webmanifest"}]);const n="app-shell-v1",s=["/","/index.html","/main.js","/styles.css","/fallback.html","/icons/icon-192.png","/images/fallback.jpg"];self.addEventListener("install",e=>{e.waitUntil(caches.open(n).then(o=>o.addAll(s)))});self.addEventListener("fetch",e=>{if(e.request.mode==="navigate"){e.respondWith(fetch(e.request).catch(()=>caches.match("/fallback.html")));return}e.respondWith(caches.match(e.request).then(o=>o||fetch(e.request)))});workbox.routing.registerRoute(new workbox.routing.NavigationRoute(workbox.precaching.createHandlerBoundToURL("index.html")));self.addEventListener("push",e=>{console.log("[SW] Push Event Received - Production:",e);let o={title:"CurhatAnonim",body:"Pesan baru tersedia",icon:"/images/logo.png",url:"/"};try{if(e.data){const i=e.data.text();console.log("[SW] Raw notification data:",i),i&&(o=JSON.parse(i))}}catch(i){console.error("[SW] Error parsing notification:",i)}const t=new URL(o.icon,self.location.origin).href;console.log("[SW] Notification details:",{title:o.title,body:o.body,icon:t}),e.waitUntil(self.registration.showNotification(o.title,{body:o.body,icon:t,badge:"/images/logo.png",data:{url:o.url||"/"},vibrate:[200,100,200]}))});workbox.routing.registerRoute(new RegExp("https://story-api.dicoding.dev/v1/stories"),new workbox.strategies.NetworkOnly({plugins:[new workbox.backgroundSync.BackgroundSyncPlugin("storyQueue",{maxRetentionTime:24*60})]}),"POST");workbox.routing.registerRoute(({request:e})=>e.destination==="image",new workbox.strategies.CacheFirst({cacheName:"image-cache",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:100}),new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200]})],fetchOptions:{mode:"no-cors"}}));self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(o=>Promise.all(o.map(t=>{if(!t.includes("workbox")&&t!==n)return caches.delete(t)}))).then(()=>self.clients.claim()))});
